{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\kreet\\\\OneDrive\\\\Desktop\\\\HCI project codes\\\\web\\\\src\\\\components\\\\Payment.js\";\nimport React, { Component } from 'react';\nimport { Table, Row, Form, Col, Button } from 'react-bootstrap';\nimport { validateCard, validatePhone, makeReservation } from '../Services';\nimport { toast } from 'react-toastify';\n\nvar Payment =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Payment, _Component);\n\n  function Payment(props) {\n    var _this;\n\n    _classCallCheck(this, Payment);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Payment).call(this, props));\n\n    _this.handleChange = function (type) {\n      return function (event) {\n        var value = event.target.value;\n\n        if (type === 'card' || type === 'phone') {\n          _this.setState({\n            checked: type\n          });\n        } else {\n          _this.setState(_defineProperty({}, type, value));\n        }\n      };\n    };\n\n    _this.handleSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var state;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                event.stopPropagation();\n\n                _this.setState({\n                  showPaymentErr: false,\n                  showValidateErr: false\n                });\n\n                state = _this.state;\n\n                if (state.checked === 'card') {\n                  if (state.cardNo && state.cvc && state.exp) {\n                    validateCard({\n                      card: state.cardNo,\n                      cvc: state.cvc,\n                      exp: state.exp,\n                      total: state.total\n                    }).then(function (res) {\n                      if (res.validated) {\n                        _this.createReservation({\n                          card: state.cardNo\n                        });\n                      } else {\n                        _this.setState({\n                          showValidateErr: true\n                        });\n                      }\n                    }).catch(function (err) {\n                      console.log(err);\n                    });\n                  } else {\n                    _this.setState({\n                      showPaymentErr: true\n                    });\n                  }\n                }\n\n                if (state.checked === 'phone') {\n                  if (state.phoneNo && state.pin) {\n                    validatePhone({\n                      phone: state.phoneNo,\n                      pin: state.pin,\n                      total: state.total\n                    }).then(function (res) {\n                      if (res.validated) {\n                        _this.createReservation({\n                          phone: state.phoneNo\n                        });\n                      } else {\n                        _this.setState({\n                          showValidateErr: true\n                        });\n                      }\n                    }).catch(function (err) {\n                      console.log(err);\n                    });\n                  } else {\n                    _this.setState({\n                      showPaymentErr: true\n                    });\n                  }\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.createReservation = function (paymentMethod) {\n      var state = _this.state;\n      var user = localStorage.getItem('user');\n\n      if (user) {\n        user = JSON.parse(user);\n\n        var reservation = _objectSpread({}, paymentMethod, {\n          user: user._id,\n          email: user.email,\n          from: state.from.value,\n          to: state.to.value,\n          train: state.train.value,\n          trainClass: state.trainClass.value,\n          time: state.time.value,\n          qty: state.qty,\n          date: state.date,\n          amount: state.amount,\n          discount: state.discount,\n          total: state.total\n        });\n\n        makeReservation(reservation).then(function (res) {\n          toast.success(\"Successfully paid \" + reservation.total);\n\n          _this.props.history.push('/reservations');\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }\n    };\n\n    _this.state = {\n      checked: 'card',\n      errMsg: 'Please fill all the fields!!!',\n      showPaymentErr: false,\n      validateErrMsg: 'Entered data not valid!!!',\n      showValidateErr: false,\n      cardNo: '',\n      cvc: '',\n      exp: '',\n      phoneNo: '',\n      pin: ''\n    };\n    return _this;\n  }\n\n  _createClass(Payment, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.location) {\n        this.setState(_objectSpread({}, this.props.location.state));\n      }\n\n      var user = localStorage.getItem('user');\n\n      if (user) {\n        this.setState({\n          phoneNo: JSON.parse(user).phone\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUpdate\",\n    value: function componentWillUpdate() {\n      var user = localStorage.getItem('user');\n\n      if (!user) {\n        this.props.history.push('/');\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Form, {\n        style: {\n          padding: 20\n        },\n        onSubmit: function onSubmit(e) {\n          return _this2.handleSubmit(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(Row, {\n        style: {\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Form.Row, {\n        style: {\n          width: '75%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(Table, {\n        striped: true,\n        bordered: true,\n        hover: true,\n        size: \"sm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, \"Amount\"), React.createElement(\"td\", {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, this.state.amount, \" INR\")), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, \"Discount\"), React.createElement(\"td\", {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, this.state.discount, \" INR\")), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, \"Total\"), React.createElement(\"td\", {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, this.state.total, \" INR\"))))), React.createElement(Form.Row, {\n        style: {\n          width: '75%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        as: \"legend\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, \"Select a payment method\")), React.createElement(Form.Row, {\n        style: {\n          width: '75%',\n          paddingBottom: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(Form.Check, {\n        type: \"radio\",\n        label: \"Credit Card\",\n        name: \"formHorizontalRadios\",\n        id: \"formHorizontalRadios1\",\n        defaultChecked: true,\n        onChange: this.handleChange('card'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }), React.createElement(Form.Check, {\n        type: \"radio\",\n        label: \"Mobile Number\",\n        name: \"formHorizontalRadios\",\n        id: \"formHorizontalRadios2\",\n        onChange: this.handleChange('phone'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }))), this.state.checked === 'card' && React.createElement(Form.Row, {\n        style: {\n          width: '75%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"cardNo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"Card Number\"), React.createElement(Form.Control, {\n        placeholder: \"card number\",\n        onChange: this.handleChange('cardNo'),\n        value: this.state.cardNo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      })), React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"cvc\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, \"CVC Number\"), React.createElement(Form.Control, {\n        placeholder: \"CVC\",\n        onChange: this.handleChange('cvc'),\n        value: this.state.cvc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      })), React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"exp\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, \"Exp date\"), React.createElement(Form.Control, {\n        placeholder: \"dd/mm\",\n        onChange: this.handleChange('exp'),\n        value: this.state.exp,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }))), this.state.checked === 'phone' && React.createElement(Form.Row, {\n        style: {\n          width: '75%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"phoneNo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, \"Phone Number\"), React.createElement(Form.Control, {\n        placeholder: \"Phone number\",\n        onChange: this.handleChange('phoneNo'),\n        value: this.state.phoneNo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      })), React.createElement(Form.Group, {\n        as: Col,\n        controlId: \"pin\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(Form.Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"PIN\"), React.createElement(Form.Control, {\n        placeholder: \"PIN\",\n        onChange: this.handleChange('pin'),\n        value: this.state.pin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }))), React.createElement(Form.Row, {\n        style: {\n          width: '75%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, this.state.showPaymentErr && React.createElement(\"p\", {\n        style: {\n          color: 'red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, this.state.errMsg), this.state.showValidateErr && React.createElement(\"p\", {\n        style: {\n          color: 'red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, this.state.validateErrMsg)), React.createElement(Form.Row, {\n        style: {\n          width: '75%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"primary\",\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, \"Make Payment\"))));\n    }\n  }]);\n\n  return Payment;\n}(Component);\n\nexport default Payment;","map":{"version":3,"sources":["C:\\Users\\kreet\\OneDrive\\Desktop\\HCI project codes\\web\\src\\components\\Payment.js"],"names":["React","Component","Table","Row","Form","Col","Button","validateCard","validatePhone","makeReservation","toast","Payment","props","handleChange","type","event","value","target","setState","checked","handleSubmit","preventDefault","stopPropagation","showPaymentErr","showValidateErr","state","cardNo","cvc","exp","card","total","then","res","validated","createReservation","catch","err","console","log","phoneNo","pin","phone","paymentMethod","user","localStorage","getItem","JSON","parse","reservation","_id","email","from","to","train","trainClass","time","qty","date","amount","discount","success","history","push","errMsg","validateErrMsg","location","padding","e","alignItems","justifyContent","width","paddingBottom","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nimport { Table, Row, Form, Col, Button } from 'react-bootstrap'\nimport { validateCard, validatePhone, makeReservation } from '../Services'\nimport { toast } from 'react-toastify'\n\nclass Payment extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            checked: 'card',\n            errMsg: 'Please fill all the fields!!!',\n            showPaymentErr: false,\n            validateErrMsg: 'Entered data not valid!!!',\n            showValidateErr: false,\n            cardNo: '',\n            cvc: '',\n            exp: '',\n            phoneNo: '',\n            pin: ''\n        };\n    }\n\n    componentDidMount() {\n        if (this.props.location) {\n            this.setState({ ...this.props.location.state })\n        }\n        var user = localStorage.getItem('user')\n        if (user) {\n            this.setState({ phoneNo: JSON.parse(user).phone })\n        }\n    }\n\n    componentWillUpdate() {\n        var user = localStorage.getItem('user')\n        if (!user) {\n            this.props.history.push('/')\n        }\n    }\n\n    handleChange = type => event => {\n        var value = event.target.value\n        if (type === 'card' || type === 'phone') {\n            this.setState({ checked: type })\n        } else {\n            this.setState({ [type]: value })\n        }\n    }\n\n    handleSubmit = async  event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.setState({ showPaymentErr: false, showValidateErr: false })\n        const state = this.state;\n        if (state.checked === 'card') {\n            if (state.cardNo && state.cvc && state.exp) {\n                validateCard({ card: state.cardNo, cvc: state.cvc, exp: state.exp, total: state.total })\n                    .then(res => {\n                        if (res.validated) {\n                            this.createReservation({ card: state.cardNo })\n                        } else {\n                            this.setState({ showValidateErr: true })\n                        }\n                    })\n                    .catch(err => {\n                        console.log(err)\n                    })\n\n            } else {\n                this.setState({ showPaymentErr: true })\n            }\n        }\n        if (state.checked === 'phone') {\n            if (state.phoneNo && state.pin) {\n                validatePhone({ phone: state.phoneNo, pin: state.pin, total: state.total })\n                    .then(res => {\n                        if (res.validated) {\n                            this.createReservation({ phone: state.phoneNo })\n                        } else {\n                            this.setState({ showValidateErr: true })\n                        }\n                    })\n                    .catch(err => {\n                        console.log(err)\n                    })\n            } else {\n                this.setState({ showPaymentErr: true })\n            }\n        }\n    }\n\n    createReservation = (paymentMethod) => {\n        const state = this.state\n        var user = localStorage.getItem('user')\n        if (user) {\n            user = JSON.parse(user)\n            const reservation = {\n                ...paymentMethod,\n                user: user._id,\n                email: user.email,\n                from: state.from.value,\n                to: state.to.value,\n                train: state.train.value,\n                trainClass: state.trainClass.value,\n                time: state.time.value,\n                qty: state.qty,\n                date: state.date,\n                amount: state.amount,\n                discount: state.discount,\n                total: state.total\n            }\n            makeReservation(reservation)\n                .then(res => {\n                    toast.success(\"Successfully paid \" + reservation.total)\n                    this.props.history.push('/reservations')\n                })\n                .catch(err => {\n                    console.log(err)\n                })\n        }\n\n    }\n\n    render() {\n        return (\n            <Form style={{ padding: 20 }} onSubmit={(e) => this.handleSubmit(e)}>\n                <Row style={{ alignItems: 'center', justifyContent: 'center' }}>\n                    <Form.Row style={{ width: '75%' }}>\n                        <Table striped bordered hover size=\"sm\">\n                            <tbody>\n                                <tr>\n                                    <td align='right'>Amount</td>\n                                    <td align='right'>{this.state.amount} INR</td>\n                                </tr>\n                                <tr>\n                                    <td align='right'>Discount</td>\n                                    <td align='right'>{this.state.discount} INR</td>\n                                </tr>\n                                <tr>\n                                    <td align='right'>Total</td>\n                                    <td align='right'>{this.state.total} INR</td>\n                                </tr>\n                            </tbody>\n                        </Table>\n                    </Form.Row>\n                    <Form.Row style={{ width: '75%' }}>\n                        <Form.Label as=\"legend\">\n                            Select a payment method\n                        </Form.Label>\n                    </Form.Row>\n                    <Form.Row style={{ width: '75%', paddingBottom: 10 }}>\n                        <Col>\n                            <Form.Check\n                                type=\"radio\"\n                                label=\"Credit Card\"\n                                name=\"formHorizontalRadios\"\n                                id=\"formHorizontalRadios1\"\n                                defaultChecked\n                                onChange={this.handleChange('card')}\n                            />\n                            <Form.Check\n                                type=\"radio\"\n                                label=\"Mobile Number\"\n                                name=\"formHorizontalRadios\"\n                                id=\"formHorizontalRadios2\"\n                                onChange={this.handleChange('phone')}\n                            />\n                        </Col>\n                    </Form.Row>\n                    {this.state.checked === 'card' &&\n                        <Form.Row style={{ width: '75%' }}>\n                            <Form.Group as={Col} controlId=\"cardNo\">\n                                <Form.Label>Card Number</Form.Label>\n                                <Form.Control placeholder=\"card number\" onChange={this.handleChange('cardNo')} value={this.state.cardNo} />\n                            </Form.Group>\n                            <Form.Group as={Col} controlId=\"cvc\">\n                                <Form.Label>CVC Number</Form.Label>\n                                <Form.Control placeholder=\"CVC\" onChange={this.handleChange('cvc')} value={this.state.cvc} />\n                            </Form.Group>\n                            <Form.Group as={Col} controlId=\"exp\">\n                                <Form.Label>Exp date</Form.Label>\n                                <Form.Control placeholder=\"dd/mm\" onChange={this.handleChange('exp')} value={this.state.exp} />\n                            </Form.Group>\n                        </Form.Row>\n                    }\n                    {this.state.checked === 'phone' &&\n                        <Form.Row style={{ width: '75%' }}>\n                            <Form.Group as={Col} controlId=\"phoneNo\">\n                                <Form.Label>Phone Number</Form.Label>\n                                <Form.Control placeholder=\"Phone number\" onChange={this.handleChange('phoneNo')} value={this.state.phoneNo} />\n                            </Form.Group>\n                            <Form.Group as={Col} controlId=\"pin\">\n                                <Form.Label>PIN</Form.Label>\n                                <Form.Control placeholder=\"PIN\" onChange={this.handleChange('pin')} value={this.state.pin} />\n                            </Form.Group>\n                        </Form.Row>\n                    }\n                    <Form.Row style={{ width: '75%' }}>\n                        {this.state.showPaymentErr && <p style={{ color: 'red' }}>{this.state.errMsg}</p>}\n                        {this.state.showValidateErr && <p style={{ color: 'red' }}>{this.state.validateErrMsg}</p>}\n                    </Form.Row>\n                    <Form.Row style={{ width: '75%' }}>\n                        <Button variant=\"primary\" type=\"submit\">\n                            Make Payment\n                        </Button>\n                    </Form.Row>\n                </Row>\n            </Form>\n        )\n    }\n}\n\nexport default Payment"]},"metadata":{},"sourceType":"module"}